<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Album Finder</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    img { max-width: 300px; margin-top: 20px; }
    .result { margin-top: 20px; }
  </style>
</head>
<body>

  <h1>Album Explorer</h1>

  <div>
    <input id="artist" placeholder="Artist name">
    <input id="album" placeholder="Album name">
    <button id="searchBtn">Search</button>
    <button id="randomBtn">Random Album</button>
  </div>

  <div class="result" id="result"></div>

  <script>
    const resultDiv = document.getElementById('result');

    async function fetchAlbum(artist, album) {
      const query = `artist:${artist} AND release:${album}`;
      const url = `https://musicbrainz.org/ws/2/release/?query=${encodeURIComponent(query)}&fmt=json&limit=1`;

      const res = await fetch(url);
      const data = await res.json();

      if (!data.releases || data.releases.length === 0) {
        resultDiv.innerHTML = 'No results found.';
        return;
      }

      const releaseId = data.releases[0].id;
      const releaseTitle = data.releases[0]['title'];
      const artistName = data.releases[0]['artist-credit'][0].name;

      const imageUrl = `https://coverartarchive.org/release/${releaseId}/front`;

      resultDiv.innerHTML = `
        <h3>${artistName} – ${releaseTitle}</h3>
        <img src="${imageUrl}" alt="Album cover">
        <p>Release ID: ${releaseId}</p>
      `;
    }

    async function fetchRandomAlbum() {
      // Generate random offset up to 100k
      const offset = Math.floor(Math.random() * 100000);

      const url = `https://musicbrainz.org/ws/2/release/?query=primarytype:album&fmt=json&limit=1&offset=${offset}`;
      const res = await fetch(url);
      const data = await res.json();

      if (!data.releases || data.releases.length === 0) {
        resultDiv.innerHTML = 'Couldn’t find a random album. Try again.';
        return;
      }

      const releaseId = data.releases[0].id;
      const releaseTitle = data.releases[0]['title'];
      const artistName = data.releases[0]['artist-credit'][0].name;
      const imageUrl = `https://coverartarchive.org/release/${releaseId}/front`;

      resultDiv.innerHTML = `
        <h3>${artistName} – ${releaseTitle}</h3>
        <img src="${imageUrl}" alt="Album cover">
        <p>Release ID: ${releaseId}</p>
      `;
    }

    document.getElementById('searchBtn').addEventListener('click', () => {
      const artist = document.getElementById('artist').value.trim();
      const album = document.getElementById('album').value.trim();

      if (!artist || !album) {
        resultDiv.innerHTML = 'Please enter both artist and album.';
        return;
      }

      fetchAlbum(artist, album);
    });

    document.getElementById('randomBtn').addEventListener('click', () => {
      fetchRandomAlbum();
    });
  </script>

</body>
</html>